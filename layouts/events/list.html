{{ define "main" }}
{{/*
  Events list page - shows all non-expired events sorted by date (most recent first)
*/}}

{{ .Scratch.Set "scope" "list" }}

{{/* Header */}}
<header>
  {{ if .Params.showBreadcrumbs | default (site.Params.list.showBreadcrumbs | default false) }}
    {{ partial "breadcrumbs.html" . }}
  {{ else }}
    <div class="h-5"></div>
  {{ end }}
  <h1 class="mt-5 text-4xl font-extrabold text-neutral-900 dark:text-neutral">{{ .Title }}</h1>
</header>

{{/* Filter expired events using our custom partial */}}
{{ $allPages := .Pages }}
{{ $activeEvents := partial "filter-active-events.html" (dict "pages" $allPages) }}

{{/* Events list sorted by date, soonest first */}}
{{ if gt (len $activeEvents) 0 }}
  <section class="mt-6 w-full grid gap-4 sm:grid-cols-2 md:grid-cols-3">
    {{ range sort $activeEvents ".Date" "asc" }}
      {{ partial "event-card.html" (dict "page" . "showSourceBadge" true) }}
    {{ end }}
  </section>
{{/* else: no active events */}}
{{ else }}
  <section class="mt-10 prose dark:prose-invert">
    <p class="py-8 border-t">
      <em>{{ i18n "list.no_articles" | default "Aucun événement à venir" | emojify }}</em>
    </p>
  </section>
{{ end }}
{{ partial "pagination.html" . }}
{{ end }}
